# Test Vectors and Payloads {#test-vectors-and-payloads}

This section provides concrete test vectors generated using the deterministic inputs listed below.

## Deterministic Inputs {#deterministic-inputs}

| Parameter | Value (Base64URL) |
| :--- | :--- |
| `eca_uuid` | `4b6483ee-3d36-4221-ac2e-2c0271aa9d62` (String) |
| `bf` | `Be80sHHnLhyYH_koGgKTFA` |
| `if` | `aS1kODFhOTc4N2U5MWQ1MTZk` |
| `vf` | `A-g7iYp8nS5Q-1t_1A1gAFpsgAnJb2DE8_2j2b6b2b4` |
| `vnonce` | `VGhpcyBpcyBhIHZub25jZQ` |
| `verifier_priv_key` | `T2vjA9ssm2E-s2e-8a0A6c0d8f0A4c0B8g0B2a0E6e0F8g0B2a0E4c0d6e0F2a0B` |
| `iat`/`nbf` | `1759020000` (Integer) |
| `exp` | `1759020300` (Integer) |

## Phase 1: Attester to Verifier {#phase-1-attester-to-verifier}

* **CBOR Payload (Hex):** `a2676b656d5f7075625820a7238510a716447881c798033b2591a329d70d473b1f31b25e79c5324ab2a5436369686278407d772921258b68a41a4825ce2de85626305a4e5113d03bb63222338248d5516a`
* **HMAC Tag (Hex):** `47f607144e54619b165b4528174542d9972332617f699043236e7655938d2146`

## Phase 2: Verifier to Attester {#phase-2-verifier-to-attester}

* **COSE_Sign1 (Hex):** `8443a10127a1045820f18146247c40465243179a32c286d933b499a22f4b0653063529b3506e5793085888a261437882692d38642d31624e2d397a502d356f4e2d38774d2d39774e2d37764c2d396f4d2d3572502d336f4e2d31724d2d3977502d38764e2d377a4d2d386f4e2d3977502d37774d2d36724e2d39774d66766e6f6e6365781656476870637942706379426849485a756232356a5a515840a1b5d1e433433ad75a7b5a59334d58045e057139169a83852230413009180709b8602b11548a339598818822306716a4a95829810a08e612809e3557e05`

## Phase 3: Attester to Verifier (Evidence EAT) {#phase-3-attester-to-verifier-evidence-eat}

* **COSE_Sign1 (Hex):** `8443a10127a10458200e6d6d4d12228518898144216834162002364402633005510680104163486048590181b8f602041a68c48d601a01041a0105021a68c48d68061a68c48d6007782434623634383365652d336433362d343232312d616332652d3263303237316161396436320a781656476870637942706379426849485a756232356a5a5118ff784061396238633764366535663461336232633164306539663861376236633564346533663261316230633964386537663661356234633364326531663061396238190109782475726e3a696574663a706172616d733a6561743a70726f66696c653a6563612d76311901117840376437373239323132353862363861343161343832356365326465383536323633303561346535313133643033626236333232323333383234386435353136611901127823534f6d652d504f502d7461472d696e2d62417365363475526c2d666f526d41741901136b6174746573746174696f6e1901147840663965386437633662356134663365326431633062396138663765366435633462336132663165306439633862376136663565346433633262316130663965385840d21a50587d40232c45f8f84724335c0a37397b9870020a160868132924300302061418435860361324386001292024103868032608481230483429381640`

## Verifier Attestation Result (AR) {#verifier-attestation-result-ar}

* **COSE_Sign1 (Hex):** `8443a10127a1045820f18146247c40465243179a32c286d933b499a22f4b0653063529b3506e5793085860a5017576657269666965722d696e7374616e63652d30303102784061396238633764366535663461336232633164306539663861376236633564346533663261316230633964386537663661356234633364326531663061396238061a68c48d6507782434623634383365652d336433362d343232312d616332652d326330323731616139643632381a00280004782475726e3a696574663a706172616d733a726174733a7374617475733a73756363657373584090280385293810842813952809481943890258102850918501294890248190382958019489038209859018491809385901384901839285901839285091830`

## CDDL Schemas {#cddl-schemas}

The following CDDL definitions describe the canonical structure of the protocol payloads.

```cddl
; Phase 1: Attester's initial proof
Phase1Payload = {
  "kem_pub": bstr .size 32,
  "ihb": tstr
}

; Phase 2: Verifier's challenge
Phase2Payload = {
  "C": tstr,
  "vnonce": tstr
}

; Phase 3: Attester's final evidence
EvidenceEAT = {
  2 => tstr,           ; sub (EUID)
  4 => uint,           ; exp
  5 => uint,           ; nbf
  6 => uint,           ; iat
  7 => tstr,           ; jti (eca_uuid)
  10 => tstr,          ; nonce
  256 => tstr,         ; EUID
  265 => tstr,         ; eat_profile
  273 => tstr,         ; Measurements (IHB)
  274 => tstr,         ; PoP
  275 => tstr,         ; IntendedUse
  276 => tstr          ; JP
}

; Final Attestation Result from Verifier
AttestationResult = {
  1 => tstr,           ; iss
  2 => tstr,           ; sub (EUID)
  6 => uint,           ; iat
  7 => tstr,           ; jti (eca_uuid)
  -262148 => tstr      ; status
}
```

### Interop Fixtures (JSON)

This JSON object contains all deterministic values and artifacts as hex-encoded strings, suitable for automated testing.

```json
{
  "deterministic_inputs": {
    "eca_uuid": "4b6483ee-3d36-4221-ac2e-2c0271aa9d62",
    "bf_b64url": "Be80sHHnLhyYH_koGgKTFA",
    "if_b64url": "aS1kODFhOTc4N2U5MWQ1MTZk",
    "vf_b64url": "A-g7iYp8nS5Q-1t_1A1gAFpsgAnJb2DE8_2j2b6b2b4",
    "vnonce_b64url": "VGhpcyBpcyBhIHZub25jZQ",
    "timestamps": {
      "iat": 1759020000,
      "nbf": 1759020000,
      "exp": 1759020300
    }
  },
  "phase_1": {
    "payload_cbor_hex": "a2676b656d5f7075625820a7238510a716447881c798033b2591a329d70d473b1f31b25e79c5324ab2a5436369686278407d772921258b68a41a4825ce2de85626305a4e5113d03bb63222338248d5516a",
    "mac_hex": "47f607144e54619b165b4528174542d9972332617f699043236e7655938d2146"
  },
  "phase_2": {
    "cose_sign1_hex": "8443a10127a1045820f18146247c40465243179a32c286d933b499a22f4b0653063529b3506e5793085888a261437882692d38642d31624e2d397a502d356f4e2d38774d2d39774e2d37764c2d396f4d2d3572502d336f4e2d31724d2d3977502d38764e2d377a4d2d386f4e2d3977502d37774d2d36724e2d39774d66766e6f6e6365781656476870637942706379426849485a756232356a5a515840a1b5d1e433433ad75a7b5a59334d58045e057139169a83852230413009180709b8602b11548a339598818822306716a4a95829810a08e612809e3557e05"
  },
  "phase_3_evidence": {
    "cose_sign1_hex": "8443a10127a10458200e6d6d4d12228518898144216834162002364402633005510680104163486048590181b8f602041a68c48d601a01041a0105021a68c48d68061a68c48d6007782434623634383365652d336433362d343232312d616332652d3263303237316161396436320a781656476870637942706379426849485a756232356a5a5118ff784061396238633764366535663461336232633164306539663861376236633564346533663261316230633964386537663661356234633364326531663061396238190109782475726e3a696574663a706172616d733a6561743a70726f66696c653a6563612d76311901117840376437373239323132353862363861343161343832356365326465383536323633303561346535313133643033626236333232323333383234386435353136611901127823534f6d652d504f502d7461472d696e2d62417365363475526c2d666f526d41741901136b6174746573746174696f6e1901147840663965386437633662356134663365326431633062396138663765366435633462336132663165306439633862376136663565346433633262316130663965385840d21a50587d40232c45f8f84724335c0a37397b9870020a160868132924300302061418435860361324386001292024103868032608481230483429381640"
  },
  "attestation_result": {
    "cose_sign1_hex": "8443a10127a1045820f18146247c40465243179a32c286d933b499a22f4b0653063529b3506e5793085860a5017576657269666965722d696e7374616e63652d30303102784061396238633764366535663461336232633164306539663861376236633564346533663261316230633964386537663661356234633364326531663061396238061a68c48d6507782434623634383365652d336433362d343232312d616332652d326330323731616139643632381a00280004782475726e3a696574663a706172616d733a726174733a7374617475733a73756363657373584090280385293810842813952809481943890258102850918501294890248190382958019489038209859018491809385901384901839285901839285091830"
  }
}
```
